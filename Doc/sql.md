# SQL: Оценки студентов

### A. Выборка данных 
Дана база данных с учениками и
оценками.

Таблица students содержит очки студента (marks).

Таблица grade - содержит соотношение очков к оценке студента.
Нужно написать запрос в базу данных, содержащий три столбца:
name, grade и mark.

- данные должны быть в порядке убывания оценок, более
высокие оценки выводятся первыми
- если есть более одного ученика с одинаковой оценкой (8-
10), упорядочьте этих конкретных учеников по их именам
в алфавитном порядке
- если оценка ниже 8, используйте “low” в качестве их имени
и перечислите по оценкам в порядке убывания
- если есть более одного учащегося с одинаковой оценкой (1-
7), упорядочите этих конкретных учащихся по их оценкам в
порядке возрастания

#### Ответ:

```sql
SELECT CASE
    WHEN grade > 7 THEN name
    ELSE "low"
    end AS names,
    grade,
    marks
FROM students
    JOIN grade
    ON marks BETWEEN min_mark AND max_mark
ORDER BY grade DESC,
    names ASC,
    marks ASC;
```
результат:
```
John	10	95
Maria	10	95
Liam	9	87
Robert	9	83
low	7	64
low	7	65
```
### B. Модификация DDL 
Предполагается, что таблица со
студентами будет хранить данные свыше двух миллионов
студентов и дальше будет только расти. Как бы вы модифицировали
таблицы базы данных, при учете, что поле grade из таблицы grade
всегда участвует в запросах к получению данных о студенте?

```sql
create table grade
(
    grade int null,
    min_mark int null,
    max_mark int null
);
create table students
(
    id int null,
    name varchar(100) null,
    marks int null
)

```

#### Ответ:

В данных условиях оптимизация будет преждевременной - база данных оптимизируется под задачу, имея в виду как конкретный набор запросов, так и конкретные сценарии их применения, частоту, ожидаемые результаты etc. В зависимости от этих обстоятельств, могут потребоваться (или не потребоваться) совершенно разные оптимизации.

Если нам будет часто требоваться grade, возможно, имеет смысл денормализовать таблицы - включить поле grade в students в явной форме, предварительно вычислив его для каждого студента.

Применение индексов на такой структуре данных, скорее всего, только помешает.



